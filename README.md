# Jobcan Data Integrator

　Jobcan Data Integratorは、ジョブカン経費精算/ワークフローAPIを介して、ジョブカンの申請書データなどをローカルのデータベースに保存するソフトウェアです。ODBC connectorを利用し、ExcelやPower BIなどのソフトウェアと接続することが可能です。

## 目次

- [目次](#目次)
- [おことわり](#おことわり)
- [概要](#概要)
- [使い方](#使い方)
  - [インストール](#インストール)
  - [Excelなどとの接続方法](#excelなどとの接続方法)
  - [データベースの構成](#データベースの構成)
  - [Q\&A](#qa)
- [技術データ](#技術データ)
  - [開発環境](#開発環境)
  - [ビルド方法](#ビルド方法)

## おことわり

　本ソフトウェアは、ジョブカン経費精算/ワークフローAPIを利用しています。そのため、ジョブカンの利用規約に従ってご利用ください。また、本ソフトウェアを利用することによって生じた損害について、一切の責任を負いかねますので、ご了承ください。

　また、ジョブカンの提供するAPIは現在β版であり、仕様が変更される可能性があります。そのため、本ソフトウェアの動作が保証されるわけではありません。ご了承ください。

> **制限事項**：本ソフトウェアは当初、ジョブカン経費精算の申請書CSVデータをAPIを介して自動取得することを目的として開発されました。しかしながら、現行のAPIには機能制限があり、CSVで提供されている全てのデータ項目を取得することができません。そのため、本ソフトウェアで取得・保存されるデータは、APIで提供されている範囲に限定されることをご了承ください。詳細については、[Q&A](doc/Q&A.md#特定の申請書に対応する仕訳情報fix_journalsが存在しません)を参照してください。

## 概要

　**Jobcan Data Integrator**は、ジョブカン経費精算の扱う申請書データ等の取得、Power BI等への同期を自動化するためのソフトウェアです。

　申請書をPower BI等へ同期させる場合、従来はすべての申請書をCSVとして毎日ダウンロードし、これをPower BIに取り込む必要がありました。しかし、本ソフトウェアを利用することで、申請書データを自動的に取得し、データベースに保存することができます。

<img src="doc/img/システム全体像.png" alt="システム全体像_ジョブカン経費精算と各PCのExcelの間を、本ソフトウェアが取り持つ">

**図** システム全体像

## 使い方

### インストール

　また、本ソフトウェアは「ジョブカンワークフロー」または「ジョブカン経費精算」のアカウントを必要とします。アカウントの管理画面から API Token が取得できますので、それを利用してください。詳細については、[公式サイト](https://ssl.wf.jobcan.jp/api_doc#header-%E5%BF%85%E8%A6%81%E3%81%AA%E3%82%82%E3%81%AE)を参照してください。

### Excelなどとの接続方法

　本ソフトウェアと同じパソコンで動くExcelとの接続方法については、[Excelとの接続](doc/Tips.md#excel-との接続)を参照してください。

　Power BI Service (EdgeやChromeなどのブラウザからアクセスするPower BI) を介した (Excelなどへの) 接続方法については、[Power BI (Service) を介した接続](doc/Tips.md#power-bi-service-を介した接続)を参照してください。

### データベースの構成

　本ソフトウェアでは、データベースとしてSQLiteを使用しています。SQLiteは、ファイルベースのデータベースであり、他のデータベースと異なり、サーバーを立てる必要がありません。そのため、データベースの構築が容易です。

　本ソフトウェアが作成するデータベース上のテーブル情報については、[テーブル情報](doc/DB-テーブル構造.md)を参照してください。

### Q&A

　本ソフトウェアの利用にあたってのQ&Aについては、[Q&A](doc/Q%26A.md)を参照してください。

## 技術データ

### 開発環境

- Windows 11
- Python 3.9.10

### ビルド方法

　本ソフトウェアは`nuitka`を用いてビルドしています。詳細は[ビルド方法](doc/Tips.md#ソフトウェアのビルド)を参照してください。
